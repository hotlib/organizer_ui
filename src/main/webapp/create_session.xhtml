<ui:composition template="welcome.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j">


<!-- #{rich:component('createdSessions')}.deselectRow(0); 
-->
	<ui:define name="content">
		<h2>Include create</h2>
		<h:form id="sessionTable">
			<a4j:commandButton value="Add"
				action="#{gameSessionManager.createSession}" render="sessionTable, :res" 
				oncomplete="#{rich:component('createdSessions')}.selectRow(#{gameSessionManager.lastIndex}); #{rich:component('createdSessions')}.setActiveRow(#{gameSessionManager.lastIndex});"
				/>

			<rich:extendedDataTable value="#{gameSessionManager.gameSessions}"
				var="gameSession"
				rendered="#{not empty gameSessionManager.gameSessions}"
				selectionMode="single" id="createdSessions">

				<a4j:ajax execute="aaa" event="selectionchange"
					listener="#{gameSessionManager.selection}" render=":res" />

				<rich:column>
					<f:facet name="header">Place</f:facet>
					<h:outputText value="#{gameSession.place}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">Session begin</f:facet>
					<h:outputText value="#{gameSession.sessionBegin}" >
					 <f:convertDateTime type="date" pattern="dd-MM-yyyy HH:mm"/>
					</h:outputText>
				</rich:column>
				<rich:column>
					<f:facet name="header">Action</f:facet>

					<h:commandButton value="Delete"
						action="#{gameSessionManager.deleteSession(gameSession)}" />

				</rich:column>
			</rich:extendedDataTable>

		</h:form>
		<h:form>
			<a4j:outputPanel id="res">
				<h:panelGrid columns="2">
					<h:outputText value="Place:" />
					<h:inputText value="#{gameSessionManager.selectionItem.place}" />
					<h:outputText value="Username:" />
					<h:inputText value="#{gameSessionManager.selectionItem.username}" />
					<h:outputText value="Date and time:" />
					<rich:calendar locale="de/DE" popup="true" value="#{gameSessionManager.selectionItem.sessionBegin}"
						datePattern="dd/M/yy HH:mm" showApplyButton="false"
						cellWidth="24px" cellHeight="22px" style="width:200px">
					</rich:calendar>

					<h:commandButton value="Save" render="sessionTable" />
				</h:panelGrid>
			</a4j:outputPanel>
		</h:form>

	</ui:define>
</ui:composition>

