<ui:composition template="welcome.xhtml"
	mlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j">



	<ui:define name="content">


		<h:form>
			<rich:extendedDataTable value="#{gameSessionManager.gameSessions}"
				var="gameSession"
				rendered="#{not empty gameSessionManager.gameSessions}" width="100%"
				style="height:100%; width:100%;" selectionMode="single"
				id="searchTable">

				<a4j:ajax execute="@this" event="selectionchange"
					listener="#{gameSessionManager.selection}" render=":res" />

				<f:facet name="caption">
					<h:outputText value="Game sessions" />
				</f:facet>
				<rich:column>
					<f:facet name="header">Place</f:facet>
					<h:outputText value="#{gameSession.place}" />
				</rich:column>
				<rich:column width="100px">
					<f:facet name="header">Players</f:facet>
					<h:outputText value="#{gameSession.joinedUsers.size()}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">Session begin</f:facet>
					<h:outputText value="#{gameSession.sessionBegin}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">Action</f:facet>

					<a4j:commandLink value="#{gameSession.joined ? 'Leave' : 'Join'}"
						style="float: left;" render="searchTable, additionalInfo" execute="@this"
						action="#{gameSession.flipJoined}" />
				
				</rich:column>
			</rich:extendedDataTable>

			<a4j:outputPanel id="additionalInfo">

				<h:panelGrid columns="3" id="updateInfo"
					rendered="#{not empty gameSessionManager.selectionItem and gameSessionManager.selectionItem.joined}">
					<h:outputText value="Game request:" />
					<h:inputText value="#{gameSessionManager.selectionItem.place}" />

					<h:commandButton value="update" render="searchTable"
						execute="updateInfo" />

				</h:panelGrid>

				<rich:extendedDataTable
					value="#{gameSessionManager.selectionItem.joinedUsers}"
					var="player"
					rendered="#{not empty gameSessionManager.selectionItem.joinedUsers}"
					selectionMode="none" id="joinedPlayers">

					<rich:column width="100px">
						<f:facet name="header">Player name</f:facet>
						<h:outputText value="#{player.username}" />
					</rich:column>
					<rich:column width="650px">
						<f:facet name="header">Recommendation</f:facet>
						<h:outputText value="#{player.request}" />
					</rich:column>
				</rich:extendedDataTable>


			</a4j:outputPanel>










		</h:form>
	</ui:define>
</ui:composition>